---
title: "HW6"
author: "Xinyu Shen xs2384"
date: "2019/11/22"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(modelr)
library(purrr)
```


## Problem 1


#### Import and clean the data


```{r, warning=FALSE}

df = read_csv("./data/birthweight.csv") %>% janitor::clean_names() %>% mutate(
  babysex = as.factor(babysex),
  frace = as.factor(frace),
  malform = as.factor(malform),
  mrace = as.factor(mrace)
)

# check missing value
nrow(df[is.na(df),])

```

From above, we can see that there is no missing value in the dataset. 



#### Model Selection


I use the stepwise to select model

```{r}

best_model = step(lm(bwt~., data = df), direction = "backward")


```


The model selected by stepwise is:

```{r}
best_model$call
```






